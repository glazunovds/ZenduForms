<div class="table-wrapper">
	<ng-container *ngIf="isLoading">
		<div class="loading">
			<mat-spinner></mat-spinner>
		</div>
	</ng-container>
	<ng-container>
		<table [dataSource]="dataSource" class="mat-elevation-z8" mat-table matSort>
			<ng-container matColumnDef="select">
				<th *matHeaderCellDef mat-header-cell>
					<mat-checkbox
						(change)="$event ? masterToggle() : null"
						[checked]="selection.hasValue() && isAllSelected()"
						[indeterminate]="selection.hasValue() && !isAllSelected()"
						color="primary"
					>
					</mat-checkbox>
				</th>
				<td *matCellDef="let row" mat-cell>
					<mat-checkbox
						(change)="$event ? selection.toggle(row) : null"
						(click)="$event.stopPropagation()"
						[checked]="selection.isSelected(row)"
						color="primary"
					>
					</mat-checkbox>
				</td>
			</ng-container>

			<ng-container matColumnDef="taskName">
				<th *matHeaderCellDef mat-header-cell>Task</th>
				<td *matCellDef="let element" mat-cell>{{ element['taskName'] }}</td>
			</ng-container>

			<ng-container matColumnDef="status">
				<th *matHeaderCellDef mat-header-cell mat-sort-header="status">Status</th>
				<td *matCellDef="let element" mat-cell>
					<div [ngClass]="element['status']" class="table-status">
						<div class="status-circle"></div>
						{{ element['status'] }}
					</div>
				</td>
			</ng-container>

			<ng-container matColumnDef="emailFrom">
				<th *matHeaderCellDef mat-header-cell>From</th>
				<td *matCellDef="let element" mat-cell>{{ element['emailFrom'] }}</td>
			</ng-container>

			<ng-container matColumnDef="emailTo">
				<th *matHeaderCellDef mat-header-cell>To</th>
				<td *matCellDef="let element" mat-cell>{{ element['emailTo'] }}</td>
			</ng-container>

			<ng-container matColumnDef="customerAddress">
				<th *matHeaderCellDef mat-header-cell>Customer Address</th>
				<td *matCellDef="let element" mat-cell>{{ element['customerAddress'] }}</td>
			</ng-container>

			<ng-container matColumnDef="dueDate">
				<th *matHeaderCellDef mat-header-cell>Due Date</th>
				<td
					*matCellDef="let element"
					mat-cell
					[ngClass]="
						today.getTime() - element['dueDateRaw'] < 1000 * 60 * 60 * 72
							? 'overdue'
							: ''
					"
				>
					{{ element['dueDate'] }}
					{{ element['dueDateShow'] }}
				</td>
			</ng-container>

			<tr *matHeaderRowDef="displayedColumns" mat-header-row></tr>
			<tr *matRowDef="let row; columns: displayedColumns" mat-row></tr>
		</table>
		<mat-paginator
			aria-label="Select page of periodic elements"
			pageSize="10"
			showFirstLastButtons
		>
		</mat-paginator>
	</ng-container>
</div>
